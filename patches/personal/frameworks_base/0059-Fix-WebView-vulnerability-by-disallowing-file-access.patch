From d7913c9fa6584d5a380295c309bc53e5ed21df3e Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Fri, 13 Nov 2020 13:27:03 -0500
Subject: [PATCH 059/210] Fix WebView vulnerability by disallowing file access

  from
  https://github.com/LineageOS/android_frameworks_base/commit/e31f210618cfde757ce18918ab5ba419e7e0e0de
---
 .../android/carrierdefaultapp/CaptivePortalLoginActivity.java    | 1 +
 1 file changed, 1 insertion(+)

diff --git a/packages/CarrierDefaultApp/src/com/android/carrierdefaultapp/CaptivePortalLoginActivity.java b/packages/CarrierDefaultApp/src/com/android/carrierdefaultapp/CaptivePortalLoginActivity.java
index 50542818e0d..6fab9e4641b 100644
--- a/packages/CarrierDefaultApp/src/com/android/carrierdefaultapp/CaptivePortalLoginActivity.java
+++ b/packages/CarrierDefaultApp/src/com/android/carrierdefaultapp/CaptivePortalLoginActivity.java
@@ -106,6 +106,7 @@ public class CaptivePortalLoginActivity extends Activity {
         webSettings.setSupportZoom(true);
         webSettings.setBuiltInZoomControls(true);
         webSettings.setDomStorageEnabled(true);
+        webSettings.setAllowFileAccess(false);
         mWebViewClient = new MyWebViewClient();
         mWebView.setWebViewClient(mWebViewClient);
         mWebView.setWebChromeClient(new MyWebChromeClient());
-- 
2.17.1

