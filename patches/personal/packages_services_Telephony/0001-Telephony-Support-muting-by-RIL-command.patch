From ac350f6f37617ace340466b442c7ad5bd5a89220 Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Sun, 13 Dec 2020 09:02:56 -0500
Subject: [PATCH] Telephony: Support muting by RIL command

  from
  https://github.com/phhusson/platform_packages_services_Telephony/commit/f17aca913f74aa58a9347ee56b0abea1e21c5340

Change-Id: Ifcfed2c1272c237526f5425837bf7ae76424ff89
---
 src/com/android/services/telephony/TelephonyConnection.java | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/com/android/services/telephony/TelephonyConnection.java b/src/com/android/services/telephony/TelephonyConnection.java
index b4dd050ee..52224f8f1 100755
--- a/src/com/android/services/telephony/TelephonyConnection.java
+++ b/src/com/android/services/telephony/TelephonyConnection.java
@@ -28,6 +28,7 @@ import android.os.Handler;
 import android.os.Looper;
 import android.os.Message;
 import android.os.PersistableBundle;
+import android.os.SystemProperties;
 import android.telecom.CallAudioState;
 import android.telecom.Conference;
 import android.telecom.Connection;
@@ -822,6 +823,10 @@ abstract class TelephonyConnection extends Connection implements Holdable {
         // TODO: update TTY mode.
         if (getPhone() != null) {
             getPhone().setEchoSuppressionEnabled();
+
+        if (SystemProperties.getBoolean("persist.sys.radio.huawei", false)) {
+                getPhone().setMute(audioState.isMuted());
+            }
         }
     }
 
-- 
2.17.1

